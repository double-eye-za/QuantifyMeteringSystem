{% extends "base.html" %} {% block title %}Unit A-101 Details - Quantify
Metering System{% endblock %} {% block page_title %}Unit A-101 Details{%
endblock %} {% block breadcrumb %}

<a href="{{ url_for('api_v1.dashboard') }}" class="hover:text-primary">Home</a>
<span class="mx-1">/</span>
<a href="{{ url_for('api_v1.estates_page') }}" class="hover:text-primary"
  >Estates</a
>
<span class="mx-1">/</span>
<a href="{{ url_for('api_v1.units_page') }}" class="hover:text-primary"
  >Units</a
>
<span class="mx-1">/</span>
<span>Unit A-101</span>
{% endblock %} {% block content %}
<!-- Critical Alert if Low/No Balance -->
<div
  class="bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-300 dark:border-yellow-700 rounded-lg p-4 mb-6"
>
  <div class="flex items-center">
    <i class="fas fa-exclamation-triangle text-yellow-600 text-xl mr-3"></i>
    <div class="flex-1">
      <p class="text-sm font-semibold text-yellow-800 dark:text-yellow-200">
        Low Wallet Balance Warning
      </p>
      <p class="text-xs text-yellow-600 dark:text-yellow-400 mt-1">
        This unit has only R 32.50 remaining. Electricity will be disconnected
        when balance reaches R 0.00
      </p>
    </div>
    <button
      class="px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"
    >
      <i class="fas fa-credit-card mr-2"></i>Top Up Now
    </button>
  </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
  <!-- Left Column - Unit & Resident Info -->
  <div class="lg:col-span-1 space-y-6">
    <!-- Unit Information -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">
        <i class="fas fa-home text-primary mr-2"></i>Unit Information
      </h3>
      <div class="space-y-3">
        <div
          class="flex justify-between py-2 border-b border-gray-100 dark:border-gray-700"
        >
          <span class="text-sm text-gray-600 dark:text-gray-400"
            >Unit Number</span
          >
          <span class="text-sm font-medium text-gray-900 dark:text-white"
            >A-101</span
          >
        </div>
        <div
          class="flex justify-between py-2 border-b border-gray-100 dark:border-gray-700"
        >
          <span class="text-sm text-gray-600 dark:text-gray-400">Estate</span>
          <span class="text-sm font-medium text-gray-900 dark:text-white"
            >Willow Creek Residential</span
          >
        </div>
        <div
          class="flex justify-between py-2 border-b border-gray-100 dark:border-gray-700"
        >
          <span class="text-sm text-gray-600 dark:text-gray-400">Floor</span>
          <span class="text-sm font-medium text-gray-900 dark:text-white"
            >Ground Floor</span
          >
        </div>
        <div
          class="flex justify-between py-2 border-b border-gray-100 dark:border-gray-700"
        >
          <span class="text-sm text-gray-600 dark:text-gray-400">Size</span>
          <span class="text-sm font-medium text-gray-900 dark:text-white"
            >85 m²</span
          >
        </div>
        <div class="flex justify-between py-2">
          <span class="text-sm text-gray-600 dark:text-gray-400"
            >Occupancy Status</span
          >
          <span
            class="inline-flex items-center px-2 py-1 rounded text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300"
          >
            <i class="fas fa-check-circle mr-1"></i>Occupied
          </span>
        </div>
      </div>
    </div>

    <!-- Resident Contact Details -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">
        <i class="fas fa-user text-primary mr-2"></i>Resident Details
      </h3>
      <div class="space-y-3">
        <div
          class="flex justify-between py-2 border-b border-gray-100 dark:border-gray-700"
        >
          <span class="text-sm text-gray-600 dark:text-gray-400">Name</span>
          <span class="text-sm font-medium text-gray-900 dark:text-white"
            >John Smith</span
          >
        </div>
        <div
          class="flex justify-between py-2 border-b border-gray-100 dark:border-gray-700"
        >
          <span class="text-sm text-gray-600 dark:text-gray-400"
            >ID Number</span
          >
          <span class="text-sm font-medium text-gray-900 dark:text-white"
            >850512****</span
          >
        </div>
        <div
          class="flex justify-between py-2 border-b border-gray-100 dark:border-gray-700"
        >
          <span class="text-sm text-gray-600 dark:text-gray-400">Mobile</span>
          <span class="text-sm font-medium text-gray-900 dark:text-white">
            +27 82 123 4567
            <button class="ml-2 text-primary hover:text-blue-700">
              <i class="fas fa-phone text-xs"></i>
            </button>
          </span>
        </div>
        <div
          class="flex justify-between py-2 border-b border-gray-100 dark:border-gray-700"
        >
          <span class="text-sm text-gray-600 dark:text-gray-400">Email</span>
          <span class="text-sm font-medium text-gray-900 dark:text-white">
            john.smith@email.com
            <button class="ml-2 text-primary hover:text-blue-700">
              <i class="fas fa-envelope text-xs"></i>
            </button>
          </span>
        </div>
        <div
          class="flex justify-between py-2 border-b border-gray-100 dark:border-gray-700"
        >
          <span class="text-sm text-gray-600 dark:text-gray-400"
            >Move-in Date</span
          >
          <span class="text-sm font-medium text-gray-900 dark:text-white"
            >15 Jan 2024</span
          >
        </div>
        <div class="flex justify-between py-2">
          <span class="text-sm text-gray-600 dark:text-gray-400"
            >Emergency Contact</span
          >
          <span class="text-sm font-medium text-gray-900 dark:text-white"
            >Jane Smith (Wife)</span
          >
        </div>
      </div>
      <button
        class="w-full mt-4 px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600"
      >
        <i class="fas fa-message mr-2"></i>Send SMS Notification
      </button>
    </div>
  </div>

  <!-- Center Column - Wallet & Meters -->
  <div class="lg:col-span-2 space-y-6">
    <!-- Prepaid Wallet Status -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
          <i class="fas fa-wallet text-primary mr-2"></i>Prepaid Wallet & Solar
          Allocation
        </h3>
        <button
          class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-600"
        >
          <i class="fas fa-plus-circle mr-2"></i>Top Up Wallet
        </button>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <!-- Wallet Balance -->
        <div
          class="bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800"
        >
          <div class="flex items-center justify-between mb-2">
            <span class="text-sm font-medium text-gray-700 dark:text-gray-300"
              >Wallet Balance</span
            >
            <i class="fas fa-exclamation-triangle text-yellow-500"></i>
          </div>
          <div class="text-2xl font-bold text-yellow-600 animate-pulse">
            R 32.50
          </div>
          <div class="mt-2 w-full bg-gray-200 rounded-full h-2">
            <div
              class="bg-yellow-500 h-2 rounded-full animate-pulse"
              style="width: 6%"
            ></div>
          </div>
          <p
            class="text-xs text-yellow-600 dark:text-yellow-400 mt-2 font-semibold"
          >
            ⚠️ Low Balance - 1.5 days left
          </p>
        </div>

        <!-- Free Solar Balance -->
        <div
          class="bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800"
        >
          <div class="flex items-center justify-between mb-2">
            <span class="text-sm font-medium text-gray-700 dark:text-gray-300"
              >Free Solar</span
            >
            <i class="fas fa-solar-panel text-green-500"></i>
          </div>
          <div class="text-2xl font-bold text-green-600">12 kWh</div>
          <div class="mt-2 w-full bg-gray-200 rounded-full h-2">
            <div class="bg-green-500 h-2 rounded-full" style="width: 24%"></div>
          </div>
          <p class="text-xs text-green-600 dark:text-green-400 mt-2">
            of 50 kWh monthly allocation
          </p>
        </div>

        <!-- Daily Consumption -->
        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
          <div class="flex items-center justify-between mb-2">
            <span class="text-sm font-medium text-gray-700 dark:text-gray-300"
              >Daily Usage</span
            >
            <i class="fas fa-chart-line text-primary"></i>
          </div>
          <div class="text-2xl font-bold text-gray-900 dark:text-white">
            R 21.50
          </div>
          <div class="text-xs text-gray-600 dark:text-gray-400 mt-2">
            <div>Electricity: R 15.00</div>
            <div>Water: R 6.50</div>
          </div>
        </div>
      </div>

      <!-- Last Transactions -->
      <div class="mt-4 border-t border-gray-200 dark:border-gray-700 pt-4">
        <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">
          Recent Transactions
        </h4>
        <div class="space-y-2">
          <div class="flex items-center justify-between text-sm">
            <span class="text-gray-600 dark:text-gray-400">Top-up</span>
            <span class="text-green-600">+R 100.00</span>
            <span class="text-gray-500 text-xs">5 days ago</span>
          </div>
          <div class="flex items-center justify-between text-sm">
            <span class="text-gray-600 dark:text-gray-400"
              >Daily consumption</span
            >
            <span class="text-red-600">-R 21.50</span>
            <span class="text-gray-500 text-xs">Yesterday</span>
          </div>
          <div class="flex items-center justify-between text-sm">
            <span class="text-gray-600 dark:text-gray-400"
              >Daily consumption</span
            >
            <span class="text-red-600">-R 22.00</span>
            <span class="text-gray-500 text-xs">2 days ago</span>
          </div>
        </div>
        <button class="text-primary hover:text-blue-700 text-sm mt-3">
          View full transaction history →
        </button>
      </div>

      <!-- Quick Actions -->
      <div class="mt-4 border-t border-gray-200 dark:border-gray-700 pt-4">
        <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">
          Quick Actions
        </h4>
        <div class="grid grid-cols-2 gap-2">
          <a
            href="{{ url_for('api_v1.wallet_statement_page', unit_id='A-101') }}"
            class="flex items-center justify-center px-3 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 text-sm"
          >
            <i class="fas fa-file-invoice mr-2"></i>View Statement
          </a>
          <a
            href="{{ url_for('api_v1.unit_visual_page', unit_id='A-101') }}"
            class="flex items-center justify-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm"
          >
            <i class="fas fa-diagram-project mr-2"></i>Visual Diagram
          </a>
        </div>
      </div>
    </div>

    <!-- Individual Meter Readings -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">
        <i class="fas fa-tachometer-alt text-primary mr-2"></i>Live Meter
        Readings
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <!-- Electricity Meter -->
        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
          <div class="flex items-center justify-between mb-3">
            <div class="flex items-center">
              <i class="fas fa-bolt text-yellow-500 mr-2"></i>
              <span class="font-medium text-gray-900 dark:text-white"
                >Electricity</span
              >
            </div>
            <span
              class="inline-flex items-center px-2 py-1 rounded text-xs bg-yellow-100 text-yellow-800"
            >
              <i class="fas fa-circle mr-1 text-xs"></i>At Risk
            </span>
          </div>
          <div class="space-y-2 text-sm">
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400">Meter ID</span>
              <span class="font-mono text-gray-900 dark:text-white"
                >E460-001</span
              >
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400"
                >Current Reading</span
              >
              <span class="font-medium text-gray-900 dark:text-white"
                >15,234.5 kWh</span
              >
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400"
                >Today's Usage</span
              >
              <span class="font-medium text-gray-900 dark:text-white"
                >8.5 kWh</span
              >
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400">Current Load</span>
              <span class="font-medium text-gray-900 dark:text-white"
                >2.4 kW</span
              >
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400">Last Update</span>
              <span class="text-green-600 text-xs">14:32:45</span>
            </div>
          </div>
          <button
            class="w-full mt-3 px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded text-sm hover:bg-gray-200 dark:hover:bg-gray-600"
          >
            View Details
          </button>
        </div>

        <!-- Water Meter -->
        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
          <div class="flex items-center justify-between mb-3">
            <div class="flex items-center">
              <i class="fas fa-tint text-blue-500 mr-2"></i>
              <span class="font-medium text-gray-900 dark:text-white"
                >Water</span
              >
            </div>
            <span
              class="inline-flex items-center px-2 py-1 rounded text-xs bg-blue-100 text-blue-800"
            >
              <i class="fas fa-circle mr-1 text-xs"></i>Flowing
            </span>
          </div>
          <div class="space-y-2 text-sm">
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400">Meter ID</span>
              <span class="font-mono text-gray-900 dark:text-white"
                >WAT-001</span
              >
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400"
                >Current Reading</span
              >
              <span class="font-medium text-gray-900 dark:text-white"
                >3,456.8 kL</span
              >
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400"
                >Today's Usage</span
              >
              <span class="font-medium text-gray-900 dark:text-white"
                >325 L</span
              >
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400">Flow Rate</span>
              <span class="font-medium text-gray-900 dark:text-white"
                >12 L/min</span
              >
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400">Last Update</span>
              <span class="text-green-600 text-xs">14:32:45</span>
            </div>
          </div>
          <button
            class="w-full mt-3 px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded text-sm hover:bg-gray-200 dark:hover:bg-gray-600"
          >
            View Details
          </button>
        </div>

        <!-- Solar Meter -->
        <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
          <div class="flex items-center justify-between mb-3">
            <div class="flex items-center">
              <i class="fas fa-solar-panel text-green-500 mr-2"></i>
              <span class="font-medium text-gray-900 dark:text-white"
                >Solar</span
              >
            </div>
            <span
              class="inline-flex items-center px-2 py-1 rounded text-xs bg-green-100 text-green-800"
            >
              <i class="fas fa-circle mr-1 text-xs"></i>Generating
            </span>
          </div>
          <div class="space-y-2 text-sm">
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400">Meter ID</span>
              <span class="font-mono text-gray-900 dark:text-white"
                >E460-002</span
              >
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400"
                >Total Generated</span
              >
              <span class="font-medium text-gray-900 dark:text-white"
                >2,150 kWh</span
              >
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400"
                >Today's Solar</span
              >
              <span class="font-medium text-gray-900 dark:text-white"
                >12.3 kWh</span
              >
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400"
                >Current Output</span
              >
              <span class="font-medium text-gray-900 dark:text-white"
                >1.8 kW</span
              >
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600 dark:text-gray-400">Last Update</span>
              <span class="text-green-600 text-xs">14:32:45</span>
            </div>
          </div>
          <button
            class="w-full mt-3 px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded text-sm hover:bg-gray-200 dark:hover:bg-gray-600"
          >
            View Details
          </button>
        </div>
      </div>
    </div>

    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
          <i class="fas fa-chart-area text-primary mr-2"></i>7-Day Consumption
          History
        </h3>
        <select
          class="px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-lg text-sm dark:bg-gray-700 text-gray-900 dark:text-white"
        >
          <option>Last 7 Days</option>
          <option>Last 30 Days</option>
          <option>This Month</option>
        </select>
      </div>
      <div class="relative h-64">
        <canvas id="consumptionChart"></canvas>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6">
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">
        Quick Actions
      </h3>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
        <button
          class="px-4 py-3 bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200 rounded-lg hover:bg-green-200 dark:hover:bg-green-900/50"
        >
          <i class="fas fa-credit-card mb-1"></i>
          <div class="text-sm">Top Up</div>
        </button>
        <button
          class="px-4 py-3 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50"
        >
          <i class="fas fa-file-invoice mb-1"></i>
          <div class="text-sm">Statement</div>
        </button>
        <button
          class="px-4 py-3 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200 rounded-lg hover:bg-yellow-200 dark:hover:bg-yellow-900/50"
        >
          <i class="fas fa-bell mb-1"></i>
          <div class="text-sm">Set Alert</div>
        </button>
        <button
          class="px-4 py-3 bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/50"
        >
          <i class="fas fa-power-off mb-1"></i>
          <div class="text-sm">Emergency</div>
        </button>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
<script>
  // Consumption Chart
  const ctx = document.getElementById("consumptionChart").getContext("2d");
  new Chart(ctx, {
    type: "line",
    data: {
      labels: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
      datasets: [
        {
          label: "Electricity (kWh)",
          data: [8.5, 9.2, 8.8, 9.5, 10.2, 7.5, 8.5],
          borderColor: "#FBBC04",
          backgroundColor: "rgba(251, 188, 4, 0.1)",
          tension: 0.4,
        },
        {
          label: "Water (L)",
          data: [320, 350, 310, 340, 380, 250, 325],
          borderColor: "#1A73E8",
          backgroundColor: "rgba(26, 115, 232, 0.1)",
          tension: 0.4,
          yAxisID: "y1",
        },
        {
          label: "Solar Generated (kWh)",
          data: [12, 13, 11, 14, 13.5, 10, 12.3],
          borderColor: "#34A853",
          backgroundColor: "rgba(52, 168, 83, 0.1)",
          tension: 0.4,
        },
      ],
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      interaction: {
        mode: "index",
        intersect: false,
      },
      scales: {
        y: {
          type: "linear",
          display: true,
          position: "left",
          title: {
            display: true,
            text: "kWh",
          },
        },
        y1: {
          type: "linear",
          display: true,
          position: "right",
          title: {
            display: true,
            text: "Liters",
          },
          grid: {
            drawOnChartArea: false,
          },
        },
      },
    },
  });
</script>
{% endblock %}
