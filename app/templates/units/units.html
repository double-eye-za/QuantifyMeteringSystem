{% extends "base.html" %} {% block title %}Unit Management - Quantify Metering
System{% endblock %} {% block page_title %}Unit Management{% endblock %} {%
block breadcrumb %}
<a href="{{ url_for('api_v1.dashboard') }}" class="hover:text-primary">Home</a>
<span class="mx-1">/</span>
<a href="{{ url_for('api_v1.estates_page') }}" class="hover:text-primary"
  >Estates</a
>
<span class="mx-1">/</span>
<span>Units</span>
{% endblock %} {% block content %}
<!-- Filters Bar -->
<div
  class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 mb-6"
>
  <div
    class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"
  >
    <div class="flex flex-wrap items-center gap-3">
      <!-- Estate Filter -->
      <select
        class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-sm text-gray-700 dark:text-gray-300"
      >
        <option>All Estates</option>
        <option>Willow Creek Estate</option>
        <option>Parkview Gardens</option>
        <option>Sunset Ridge Estate</option>
      </select>

      <!-- Search -->
      <div class="relative">
        <input
          type="text"
          placeholder="Search unit number..."
          class="pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-primary focus:border-primary"
        />
        <i
          class="fas fa-search absolute left-3 top-2.5 text-gray-400 dark:text-gray-500"
        ></i>
      </div>

      <!-- Status Filter -->
      <select
        class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-primary focus:border-primary"
      >
        <option>All Status</option>
        <option>Occupied</option>
        <option>Vacant</option>
      </select>

      <!-- Meter Status -->
      <select
        class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-primary focus:border-primary"
      >
        <option>All Meters</option>
        <option>All Connected</option>
        <option>Issues Detected</option>
      </select>
    </div>

    <div class="flex items-center gap-3">
      <button
        class="px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 text-sm transition-colors"
      >
        <i class="fas fa-file-import mr-2"></i> Import CSV
      </button>
      <button
        onclick="showAddUnitModal()"
        class="px-4 py-2 bg-primary hover:bg-blue-700 text-white rounded-lg text-sm transition-colors"
      >
        <i class="fas fa-plus mr-2"></i> Add Unit
      </button>
    </div>
  </div>
</div>

<!-- Units Table -->
<div
  class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden"
>
  <div class="overflow-x-auto">
    <table class="w-full">
      <thead
        class="bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600"
      >
        <tr>
          <th class="px-4 py-3 text-left">
            <input
              type="checkbox"
              class="rounded border-gray-300 dark:border-gray-600"
            />
          </th>
          <th
            class="px-4 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider"
          >
            Unit
          </th>
          <th
            class="px-4 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider"
          >
            Estate
          </th>
          <th
            class="px-4 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider"
          >
            Resident
          </th>
          <th
            class="px-4 py-3 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider"
          >
            Electricity
          </th>
          <th
            class="px-4 py-3 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider"
          >
            Water
          </th>
          <th
            class="px-4 py-3 text-center text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider"
          >
            Solar
          </th>
          <th
            class="px-4 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider"
          >
            Status
          </th>
          <th
            class="px-4 py-3 text-left text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wider"
          >
            Actions
          </th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
        <!-- Unit Row 1 -->
        <tr
          class="hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"
        >
          <td class="px-4 py-3">
            <input
              type="checkbox"
              class="rounded border-gray-300 dark:border-gray-600"
            />
          </td>
          <td class="px-4 py-3">
            <div>
              <a
                href="{{ url_for('api_v1.unit_details_page', unit_id=1) }}"
                class="text-sm font-medium text-primary hover:text-blue-700 hover:underline cursor-pointer"
                >Unit A-101</a
              >
              <p class="text-xs text-gray-500 dark:text-gray-400">
                Ground Floor
              </p>
            </div>
          </td>
          <td class="px-4 py-3 text-sm text-gray-900 dark:text-gray-300">
            Willow Creek
          </td>
          <td class="px-4 py-3">
            <div>
              <p class="text-sm text-gray-900 dark:text-white">John Smith</p>
              <p class="text-xs text-gray-500 dark:text-gray-400">
                +27 11 123 4567
              </p>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >E460-001</span
              >
              <span class="text-xs font-semibold text-gray-900 dark:text-white"
                >R 250.00</span
              >
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400 mt-1"
              >
                <i class="fas fa-circle mr-1" style="font-size: 6px"></i>
                Active
              </span>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >WTR-001</span
              >
              <span class="text-xs font-semibold text-gray-900 dark:text-white"
                >R 150.00</span
              >
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400 mt-1"
              >
                <i class="fas fa-circle mr-1" style="font-size: 6px"></i>
                Active
              </span>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >SOL-001</span
              >
              <span class="text-xs font-semibold text-gray-900 dark:text-white"
                >R 100.00</span
              >
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400 mt-1"
              >
                <i class="fas fa-circle mr-1" style="font-size: 6px"></i>
                Active
              </span>
            </div>
          </td>
          <td class="px-4 py-3">
            <span
              class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400"
            >
              Occupied
            </span>
          </td>
          <td class="px-4 py-3">
            <div class="flex items-center gap-2">
              <a
                href="{{ url_for('api_v1.unit_details_page', unit_id=1) }}"
                class="text-primary hover:underline text-sm"
              >
                <i class="fas fa-eye mr-1"></i>View
              </a>
              <button
                onclick="editUnit()"
                class="text-gray-600 dark:text-gray-400 hover:text-primary text-sm"
              >
                Edit
              </button>
            </div>
          </td>
        </tr>

        <!-- Unit Row 2 - Low Credit Warning -->
        <tr
          class="hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"
        >
          <td class="px-4 py-3">
            <input
              type="checkbox"
              class="rounded border-gray-300 dark:border-gray-600"
            />
          </td>
          <td class="px-4 py-3">
            <div>
              <a
                href="{{ url_for('api_v1.unit_details_page', unit_id=2) }}"
                class="text-sm font-medium text-primary hover:text-blue-700 hover:underline cursor-pointer"
                >Unit A-102</a
              >
              <p class="text-xs text-gray-500 dark:text-gray-400">
                Ground Floor
              </p>
            </div>
          </td>
          <td class="px-4 py-3 text-sm text-gray-900 dark:text-gray-300">
            Willow Creek
          </td>
          <td class="px-4 py-3">
            <div>
              <p class="text-sm text-gray-900 dark:text-white">Sarah Johnson</p>
              <p class="text-xs text-gray-500 dark:text-gray-400">
                +27 11 234 5678
              </p>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >E460-002</span
              >
              <span
                class="text-xs font-semibold text-yellow-600 dark:text-yellow-400"
                >R 25.00</span
              >
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-yellow-100 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-400 mt-1"
              >
                <i
                  class="fas fa-exclamation-triangle mr-1"
                  style="font-size: 8px"
                ></i>
                Low
              </span>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >WTR-002</span
              >
              <span class="text-xs font-semibold text-gray-900 dark:text-white"
                >R 320.00</span
              >
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400 mt-1"
              >
                <i class="fas fa-circle mr-1" style="font-size: 6px"></i>
                Active
              </span>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >SOL-002</span
              >
              <span class="text-xs font-semibold text-gray-900 dark:text-white"
                >R 450.00</span
              >
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400 mt-1"
              >
                <i class="fas fa-circle mr-1" style="font-size: 6px"></i>
                Active
              </span>
            </div>
          </td>
          <td class="px-4 py-3">
            <span
              class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400"
            >
              Occupied
            </span>
          </td>
          <td class="px-4 py-3">
            <div class="flex items-center gap-2">
              <a
                href="{{ url_for('api_v1.unit_details_page', unit_id=2) }}"
                class="text-primary hover:underline text-sm"
              >
                <i class="fas fa-eye mr-1"></i>View
              </a>
              <button
                onclick="editUnit()"
                class="text-gray-600 dark:text-gray-400 hover:text-primary text-sm"
              >
                Edit
              </button>
            </div>
          </td>
        </tr>

        <!-- Unit Row 3 - Disconnected -->
        <tr
          class="hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"
        >
          <td class="px-4 py-3">
            <input
              type="checkbox"
              class="rounded border-gray-300 dark:border-gray-600"
            />
          </td>
          <td class="px-4 py-3">
            <div>
              <a
                href="{{ url_for('api_v1.unit_details_page', unit_id=3) }}"
                class="text-sm font-medium text-primary hover:text-blue-700 hover:underline cursor-pointer"
                >Unit A-103</a
              >
              <p class="text-xs text-gray-500 dark:text-gray-400">
                Ground Floor
              </p>
            </div>
          </td>
          <td class="px-4 py-3 text-sm text-gray-900 dark:text-gray-300">
            Willow Creek
          </td>
          <td class="px-4 py-3">
            <div>
              <p class="text-sm text-gray-900 dark:text-white">Mike Chen</p>
              <p class="text-xs text-gray-500 dark:text-gray-400">
                +27 11 345 6789
              </p>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >E460-003</span
              >
              <span class="text-xs font-semibold text-red-600 dark:text-red-400"
                >R 0.00</span
              >
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-red-100 dark:bg-red-900/20 text-red-800 dark:text-red-400 mt-1"
              >
                <i class="fas fa-times-circle mr-1" style="font-size: 8px"></i>
                Disconnected
              </span>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >WTR-003</span
              >
              <span
                class="text-xs font-semibold text-yellow-600 dark:text-yellow-400"
                >R 5.00</span
              >
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-yellow-100 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-400 mt-1"
                title="Low credit warning"
              >
                <i
                  class="fas fa-exclamation-triangle mr-1"
                  style="font-size: 8px"
                ></i>
                Low Warning
              </span>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >SOL-003</span
              >
              <span class="text-xs font-semibold text-gray-900 dark:text-white"
                >R 200.00</span
              >
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400 mt-1"
              >
                <i class="fas fa-circle mr-1" style="font-size: 6px"></i>
                Active
              </span>
            </div>
          </td>
          <td class="px-4 py-3">
            <span
              class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400"
            >
              Occupied
            </span>
          </td>
          <td class="px-4 py-3">
            <div class="flex items-center gap-2">
              <a
                href="{{ url_for('api_v1.unit_details_page', unit_id=3) }}"
                class="text-primary hover:underline text-sm"
              >
                <i class="fas fa-eye mr-1"></i>View
              </a>
              <button
                onclick="editUnit()"
                class="text-gray-600 dark:text-gray-400 hover:text-primary text-sm"
              >
                Edit
              </button>
            </div>
          </td>
        </tr>

        <!-- Unit Row 4 - Vacant -->
        <tr
          class="hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors bg-gray-50/50 dark:bg-gray-700/20"
        >
          <td class="px-4 py-3">
            <input
              type="checkbox"
              class="rounded border-gray-300 dark:border-gray-600"
            />
          </td>
          <td class="px-4 py-3">
            <div>
              <p class="text-sm font-medium text-gray-900 dark:text-white">
                Unit B-201
              </p>
              <p class="text-xs text-gray-500 dark:text-gray-400">
                Second Floor
              </p>
            </div>
          </td>
          <td class="px-4 py-3 text-sm text-gray-900 dark:text-gray-300">
            Parkview Gardens
          </td>
          <td class="px-4 py-3">
            <div>
              <p class="text-sm text-gray-500 dark:text-gray-400 italic">
                No resident
              </p>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >E460-051</span
              >
              <span class="text-xs font-semibold text-gray-500">-</span>
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 mt-1"
              >
                <i class="fas fa-pause-circle mr-1" style="font-size: 8px"></i>
                Inactive
              </span>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >WTR-051</span
              >
              <span class="text-xs font-semibold text-gray-500">-</span>
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 mt-1"
              >
                <i class="fas fa-pause-circle mr-1" style="font-size: 8px"></i>
                Inactive
              </span>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >SOL-051</span
              >
              <span class="text-xs font-semibold text-gray-500">-</span>
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 mt-1"
              >
                <i class="fas fa-pause-circle mr-1" style="font-size: 8px"></i>
                Inactive
              </span>
            </div>
          </td>
          <td class="px-4 py-3">
            <span
              class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"
            >
              Vacant
            </span>
          </td>
          <td class="px-4 py-3">
            <div class="flex items-center gap-2">
              <a
                href="{{ url_for('api_v1.unit_details_page', unit_id=4) }}"
                class="text-primary hover:underline text-sm"
              >
                <i class="fas fa-eye mr-1"></i>View
              </a>
              <button
                onclick="assignResident()"
                class="text-green-600 dark:text-green-400 hover:underline text-sm"
              >
                Assign
              </button>
            </div>
          </td>
        </tr>

        <!-- More rows... -->
        <tr
          class="hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"
        >
          <td class="px-4 py-3">
            <input
              type="checkbox"
              class="rounded border-gray-300 dark:border-gray-600"
            />
          </td>
          <td class="px-4 py-3">
            <div>
              <p class="text-sm font-medium text-gray-900 dark:text-white">
                Unit B-202
              </p>
              <p class="text-xs text-gray-500 dark:text-gray-400">
                Second Floor
              </p>
            </div>
          </td>
          <td class="px-4 py-3 text-sm text-gray-900 dark:text-gray-300">
            Parkview Gardens
          </td>
          <td class="px-4 py-3">
            <div>
              <p class="text-sm text-gray-900 dark:text-white">Jane Doe</p>
              <p class="text-xs text-gray-500 dark:text-gray-400">
                +27 12 123 4567
              </p>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >E460-052</span
              >
              <span class="text-xs font-semibold text-gray-900 dark:text-white"
                >R 500.00</span
              >
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400 mt-1"
              >
                <i class="fas fa-circle mr-1" style="font-size: 6px"></i>
                Active
              </span>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >WTR-052</span
              >
              <span class="text-xs font-semibold text-gray-900 dark:text-white"
                >R 250.00</span
              >
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400 mt-1"
              >
                <i class="fas fa-circle mr-1" style="font-size: 6px"></i>
                Active
              </span>
            </div>
          </td>
          <td class="px-4 py-3 text-center">
            <div class="flex flex-col items-center">
              <span class="text-xs font-mono text-gray-600 dark:text-gray-400"
                >SOL-052</span
              >
              <span class="text-xs font-semibold text-gray-900 dark:text-white"
                >R 300.00</span
              >
              <span
                class="inline-flex items-center px-1.5 py-0.5 rounded text-xs bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400 mt-1"
              >
                <i class="fas fa-circle mr-1" style="font-size: 6px"></i>
                Active
              </span>
            </div>
          </td>
          <td class="px-4 py-3">
            <span
              class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400"
            >
              Occupied
            </span>
          </td>
          <td class="px-4 py-3">
            <div class="flex items-center gap-2">
              <a
                href="{{ url_for('api_v1.unit_details_page', unit_id=5) }}"
                class="text-primary hover:underline text-sm"
              >
                <i class="fas fa-eye mr-1"></i>View
              </a>
              <button
                onclick="editUnit()"
                class="text-gray-600 dark:text-gray-400 hover:text-primary text-sm"
              >
                Edit
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700">
    <div class="flex items-center justify-between">
      <div class="text-sm text-gray-700 dark:text-gray-300">
        Showing <span class="font-medium">1</span> to
        <span class="font-medium">5</span> of
        <span class="font-medium">100</span> units
      </div>
      <div class="flex items-center gap-2">
        <button
          class="px-3 py-1 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed"
          disabled
        >
          <i class="fas fa-chevron-left"></i>
        </button>
        <button class="px-3 py-1 bg-primary text-white rounded-lg">1</button>
        <button
          class="px-3 py-1 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700"
        >
          2
        </button>
        <button
          class="px-3 py-1 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700"
        >
          3
        </button>
        <span class="px-2 text-gray-500">...</span>
        <button
          class="px-3 py-1 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700"
        >
          20
        </button>
        <button
          class="px-3 py-1 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700"
        >
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Legend -->
<div
  class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 mt-6"
>
  <p class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3">
    Meter Status Legend:
  </p>
  <div class="flex flex-wrap gap-4 text-xs">
    <div class="flex items-center gap-1">
      <i class="fas fa-circle text-green-500" style="font-size: 8px"></i>
      <span class="text-gray-600 dark:text-gray-400"
        >Active - Service connected</span
      >
    </div>
    <div class="flex items-center gap-1">
      <i
        class="fas fa-exclamation-triangle text-yellow-600 dark:text-yellow-400"
        style="font-size: 8px"
      ></i>
      <span class="text-gray-600 dark:text-gray-400"
        >Low - Credit below R50</span
      >
    </div>
    <div class="flex items-center gap-1">
      <i
        class="fas fa-times-circle text-red-600 dark:text-red-400"
        style="font-size: 8px"
      ></i>
      <span class="text-gray-600 dark:text-gray-400"
        >Disconnected - No credit</span
      >
    </div>
    <div class="flex items-center gap-1">
      <i
        class="fas fa-faucet text-yellow-600 dark:text-yellow-400"
        style="font-size: 8px"
      ></i>
      <span class="text-gray-600 dark:text-gray-400"
        >Low Warning - Low credit warning</span
      >
    </div>
    <div class="flex items-center gap-1">
      <i class="fas fa-pause-circle text-gray-500" style="font-size: 8px"></i>
      <span class="text-gray-600 dark:text-gray-400"
        >Inactive - Unit vacant</span
      >
    </div>
  </div>
</div>

<!-- Add Unit Modal (prototype structure) -->
<div
  id="addUnitModal"
  class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4"
>
  <div
    class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
  >
    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
        Add New Unit
      </h3>
    </div>
    <div class="p-6">
      <form class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
            >
              Unit Number <span class="text-red-600 dark:text-red-400">*</span>
            </label>
            <input
              type="text"
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-primary"
              placeholder="e.g., A-101"
            />
          </div>
          <div>
            <label
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
            >
              Estate <span class="text-red-600 dark:text-red-400">*</span>
            </label>
            <select
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"
            >
              <option>Willow Creek Estate</option>
              <option>Parkview Gardens</option>
              <option>Sunset Ridge Estate</option>
            </select>
          </div>
        </div>

        <div>
          <h4
            class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"
          >
            Meter Assignment (3 meters required per unit)
          </h4>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
              >
                <i class="fas fa-bolt text-yellow-500 mr-1"></i>
                Electricity Meter (E460)
                <span class="text-red-600 dark:text-red-400">*</span>
              </label>
              <input
                type="text"
                class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-primary"
                placeholder="E460-XXX"
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
              >
                <i class="fas fa-tint text-blue-500 mr-1"></i>
                Water Meter
                <span class="text-red-600 dark:text-red-400">*</span>
              </label>
              <input
                type="text"
                class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-primary"
                placeholder="WTR-XXX"
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
              >
                <i class="fas fa-solar-panel text-orange-500 mr-1"></i>
                Solar Meter (E460)
                <span class="text-red-600 dark:text-red-400">*</span>
              </label>
              <input
                type="text"
                class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-primary"
                placeholder="SOL-XXX"
              />
            </div>
          </div>
        </div>

        <div>
          <label
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
          >
            Floor/Location
          </label>
          <input
            type="text"
            class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-primary"
            placeholder="e.g., Ground Floor"
          />
        </div>
      </form>
    </div>
    <div
      class="p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3"
    >
      <button
        onclick="hideAddUnitModal()"
        class="px-4 py-2 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-colors"
      >
        Cancel
      </button>
      <button
        onclick="saveUnit()"
        class="px-4 py-2 bg-primary hover:bg-blue-700 text-white rounded-lg transition-colors"
      >
        Add Unit
      </button>
    </div>
  </div>
</div>

<!-- Edit Unit Modal (same structure) -->
<div
  id="editUnitModal"
  class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4"
>
  <div
    class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
  >
    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
        Edit Unit
      </h3>
    </div>
    <div class="p-6">
      <form class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
              >Unit Number
              <span class="text-red-600 dark:text-red-400">*</span></label
            >
            <input
              id="edit_unit_number"
              type="text"
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-primary"
              placeholder="e.g., A-101"
            />
          </div>
          <div>
            <label
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
              >Estate
              <span class="text-red-600 dark:text-red-400">*</span></label
            >
            <select
              id="edit_unit_estate"
              class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"
            >
              <option>Willow Creek Estate</option>
              <option>Parkview Gardens</option>
              <option>Sunset Ridge Estate</option>
            </select>
          </div>
        </div>
        <div>
          <h4
            class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"
          >
            Meter Assignment (3 meters required per unit)
          </h4>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
                ><i class="fas fa-bolt text-yellow-500 mr-1"></i>Electricity
                Meter (E460)
                <span class="text-red-600 dark:text-red-400">*</span></label
              >
              <input
                id="edit_unit_emeter"
                type="text"
                class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-primary"
                placeholder="E460-XXX"
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
                ><i class="fas fa-tint text-blue-500 mr-1"></i>Water Meter
                <span class="text-red-600 dark:text-red-400">*</span></label
              >
              <input
                id="edit_unit_wmeter"
                type="text"
                class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-primary"
                placeholder="WTR-XXX"
              />
            </div>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
                ><i class="fas fa-solar-panel text-orange-500 mr-1"></i>Solar
                Meter (E460)
                <span class="text-red-600 dark:text-red-400">*</span></label
              >
              <input
                id="edit_unit_smeter"
                type="text"
                class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-primary"
                placeholder="SOL-XXX"
              />
            </div>
          </div>
        </div>
        <div>
          <label
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
            >Floor/Location</label
          >
          <input
            id="edit_unit_floor"
            type="text"
            class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary focus:border-primary"
            placeholder="e.g., Ground Floor"
          />
        </div>
      </form>
    </div>
    <div
      class="p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3"
    >
      <button
        onclick="hideEditUnitModal()"
        class="px-4 py-2 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-colors"
      >
        Cancel
      </button>
      <button
        onclick="saveEditedUnit()"
        class="px-4 py-2 bg-primary hover:bg-blue-700 text-white rounded-lg transition-colors"
      >
        Save Changes
      </button>
    </div>
  </div>
</div>
<!-- Add Unit Modal -->
<div
  id="addUnitModal"
  class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4"
>
  <div
    class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-xl w-full max-h-[90vh] overflow-y-auto"
  >
    <div
      class="p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"
    >
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
        Add New Unit
      </h3>
      <button
        onclick="hideAddUnitModal()"
        class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"
      >
        <i class="fas fa-times"></i>
      </button>
    </div>
    <form onsubmit="event.preventDefault(); saveUnit();" class="p-6 space-y-4">
      <div>
        <label
          class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
          >Unit Number</label
        >
        <input
          type="text"
          class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"
          placeholder="e.g., A-101"
          required
        />
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
            >Floor</label
          >
          <input
            type="text"
            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"
            placeholder="e.g., Ground Floor"
          />
        </div>
        <div>
          <label
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
            >Building</label
          >
          <input
            type="text"
            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"
            placeholder="e.g., Block A"
          />
        </div>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
            >Electricity Meter</label
          >
          <input
            type="text"
            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"
            placeholder="Serial e.g., E460-010"
          />
        </div>
        <div>
          <label
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
            >Water Meter</label
          >
          <input
            type="text"
            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent"
            placeholder="Serial e.g., WTR-010"
          />
        </div>
      </div>
      <div
        class="flex items-center justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700"
      >
        <button
          type="button"
          onclick="hideAddUnitModal()"
          class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"
        >
          Cancel
        </button>
        <button
          type="submit"
          class="px-4 py-2 bg-primary hover:bg-blue-700 text-white rounded-lg transition-colors"
        >
          <i class="fas fa-plus mr-2"></i>Create Unit
        </button>
      </div>
    </form>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script>
  // Unit Functions
  function showAddUnitModal() {
    document.getElementById("addUnitModal").classList.remove("hidden");
  }

  function hideAddUnitModal() {
    document.getElementById("addUnitModal").classList.add("hidden");
  }

  function saveUnit() {
    alert("Unit added successfully!");
    hideAddUnitModal();
  }

  function viewUnitDetails() {
    window.location.href = "meters.html";
  }

  function showEditUnitModal() {
    const modal = document.getElementById("editUnitModal");
    if (modal) modal.classList.remove("hidden");
  }

  function hideEditUnitModal() {
    const modal = document.getElementById("editUnitModal");
    if (modal) modal.classList.add("hidden");
  }

  function editUnit(buttonEl) {
    // Optionally populate fields from the row
    const row = buttonEl ? buttonEl.closest("tr") : null;
    if (row) {
      const unitLink = row.querySelector("td:nth-child(2) a");
      const floorText = row.querySelector("td:nth-child(2) p");
      const estateCell = row.querySelector("td:nth-child(3)");
      const emeter = row.querySelector("td:nth-child(5) span.font-mono");
      const wmeter = row.querySelector("td:nth-child(6) span.font-mono");
      const smeter = row.querySelector("td:nth-child(7) span.font-mono");

      const unitNumber = unitLink
        ? unitLink.textContent.trim().replace(/^Unit\s+/i, "")
        : "";
      const floor = floorText ? floorText.textContent.trim() : "";
      const estate = estateCell ? estateCell.textContent.trim() : "";

      const editUnitNumber = document.getElementById("edit_unit_number");
      const editUnitFloor = document.getElementById("edit_unit_floor");
      const editUnitEstate = document.getElementById("edit_unit_estate");
      const editEmeter = document.getElementById("edit_unit_emeter");
      const editWmeter = document.getElementById("edit_unit_wmeter");
      const editSmeter = document.getElementById("edit_unit_smeter");

      if (editUnitNumber) editUnitNumber.value = unitNumber || "";
      if (editUnitFloor) editUnitFloor.value = floor || "";
      if (editUnitEstate) {
        // naive selection by text match
        Array.from(editUnitEstate.options).forEach((opt) => {
          opt.selected = opt.textContent.trim() === estate;
        });
      }
      if (editEmeter && emeter) editEmeter.value = emeter.textContent.trim();
      if (editWmeter && wmeter) editWmeter.value = wmeter.textContent.trim();
      if (editSmeter && smeter) editSmeter.value = smeter.textContent.trim();
    }

    showEditUnitModal();
  }

  function assignResident() {
    alert("Assign resident modal would open here");
  }
</script>
{% endblock %}
